<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Latent Class Growth Analysis • tidySEM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Latent Class Growth Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidySEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Generating_syntax.html">Generating syntax for structural equation models</a></li>
    <li><a class="dropdown-item" href="../articles/lca_confirmatory.html">Confirmatory LPA for the Caregiver Compass</a></li>
    <li><a class="dropdown-item" href="../articles/lca_exploratory.html">Exploratory LPA for Ocean Microplastics</a></li>
    <li><a class="dropdown-item" href="../articles/lca_lcga.html">Latent Class Growth Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lca_ordinal.html">Latent Class Analysis for Ordinal Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/Plotting_graphs.html">Plotting graphs for structural equation models</a></li>
    <li><a class="dropdown-item" href="../articles/sem_graph.html">SEM graphing conventions</a></li>
    <li><a class="dropdown-item" href="../articles/SMART_LCA_checklist.html">SMART-LCA Checklist</a></li>
    <li><a class="dropdown-item" href="../articles/Tabulating_results.html">Tabulating results from structural equation models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cjvanlissa/tidySEM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Latent Class Growth Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cjvanlissa/tidySEM/blob/master/vignettes/lca_lcga.Rmd" class="external-link"><code>vignettes/lca_lcga.Rmd</code></a></small>
      <div class="d-none name"><code>lca_lcga.Rmd</code></div>
    </div>

    
    
<p>This vignette illustrated <code>tidySEM</code>’s ability to perform
latent class growth analysis, or growth mixture modeling, as explained
in Van Lissa, C. J., Garnier-Villarreal, M., &amp; Anadria, D. (2023).
<em>Recommended Practices in Latent Class Analysis using the Open-Source
R-Package tidySEM.</em> Structural Equation Modeling. <a href="https://doi.org/10.1080/10705511.2023.2250920" class="external-link uri">https://doi.org/10.1080/10705511.2023.2250920</a>. The
simulated data used for this example are inspired by work in progress by
Plas and colleagues, on heterogeneity in depression trajectories among
Dutch military personnel who were deployed to Afghanistan. The original
data were collected as part of the <em>Prospection in Stress-related
Military Research (PRISMO)</em> study, which examined of psychological
problems after deployment in more than 1,000 Dutch military personnel
from 2005-2019.</p>
<p>First, we load all required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cjvanlissa.github.io/tidySEM/">tidySEM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-preprocessing">Data preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h3>
<p>We first examined the descriptive statistics for the sum score
scales:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get descriptives</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">plas_depression</span></span>
<span><span class="va">desc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/descriptives.html">descriptives</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">desc</span> <span class="op">&lt;-</span> <span class="va">desc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"sd"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>,</span>
<span>    <span class="st">"skew_2se"</span>, <span class="st">"kurt_2se"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">desc</span>, caption <span class="op">=</span> <span class="st">"Item descriptives"</span><span class="op">)</span></span></code></pre></div>
<p>Note that all variables were extremely right-skewed due to censoring
at the lower end of the scale.</p>
<p>We can examine these distributions visually as well:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span><span class="va">df</span>, direction <span class="op">=</span> <span class="st">"long"</span>, varying <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">scl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>As this type of skew can result in convergence problems in LCGA, we
compared several transformations to reduce skew: The square and cube
root, log, inverse, and Box-Cox transformations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_scores</span> <span class="op">&lt;-</span> <span class="va">df_plot</span></span>
<span><span class="co"># Store original range of SCL</span></span>
<span><span class="va">rng_scl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">$</span><span class="va">scl</span><span class="op">)</span></span>
<span><span class="co"># Log-transform</span></span>
<span><span class="va">df_scores</span><span class="op">$</span><span class="va">log</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">$</span><span class="va">scl</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>    <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Square root transform</span></span>
<span><span class="va">df_scores</span><span class="op">$</span><span class="va">sqrt</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">$</span><span class="va">scl</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>    <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Cube root transform</span></span>
<span><span class="va">df_scores</span><span class="op">$</span><span class="va">qrt</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">$</span><span class="va">scl</span><span class="op">^</span><span class="fl">0.33</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>    <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Reciprocal transform</span></span>
<span><span class="va">df_scores</span><span class="op">$</span><span class="va">reciprocal</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">df_scores</span><span class="op">$</span><span class="va">scl</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>    <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Define function for Box-Cox transformation</span></span>
<span><span class="va">bc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">lambda</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="va">lambda</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">lambda</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Inverse Box-Cox transformation</span></span>
<span><span class="va">invbc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">lambda</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="va">lambda</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">lambda</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Box-Cox transform</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html" class="external-link">boxcox</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">$</span><span class="va">scl</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>, plotit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">df_scores</span><span class="op">$</span><span class="va">boxcox</span> <span class="op">&lt;-</span> <span class="fu">bc</span><span class="op">(</span><span class="va">df_scores</span><span class="op">$</span><span class="va">scl</span>, <span class="va">lambda</span><span class="op">)</span></span>
<span><span class="co"># Store range of Box-Cox transformed data</span></span>
<span><span class="va">rng_bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">$</span><span class="va">boxcox</span><span class="op">)</span></span>
<span><span class="va">df_scores</span><span class="op">$</span><span class="va">boxcox</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">$</span><span class="va">boxcox</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>    <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Rescale SCL</span></span>
<span><span class="va">df_scores</span><span class="op">$</span><span class="va">scl</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">$</span><span class="va">scl</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can plot these transformations:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make plot data</span></span>
<span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scl"</span>, <span class="st">"log"</span>, <span class="st">"sqrt"</span>, <span class="st">"qrt"</span>,</span>
<span>    <span class="st">"boxcox"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"id"</span><span class="op">)</span><span class="op">]</span>, Value <span class="op">=</span> <span class="va">df_scores</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        Transformation <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Value</span>, colour <span class="op">=</span> <span class="va">Transformation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_sqrt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"scl (rescaled to 0-1)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Evidently, the Box-Cox transformation reduced skew the most.
Consequently, we proceeded with the Box-Cox transformed scores for
analysis.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">df_scores</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"time"</span>, <span class="st">"boxcox"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span><span class="va">dat</span>, direction <span class="op">=</span> <span class="st">"wide"</span>, v.names <span class="op">=</span> <span class="st">"boxcox"</span>, timevar <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>    idvar <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"boxcox."</span>, <span class="st">"scl"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="latent-class-growth-analysis">Latent Class Growth Analysis<a class="anchor" aria-label="anchor" href="#latent-class-growth-analysis"></a>
</h2>
<p>Next, we estimated a latent class growth model for SCL. The model
included an overall intercept, centered at T1, <code>i</code>. To model
the potential effect of deployment on depresion, we also included a
dummy variable that was zero before deployment, and 1 after deployment,
<code>step</code>. Finally, to model potential change (or recovery) in
depression post-deployment, we included a linear slope from T2-T6,
<code>s</code>. All variances of growth parameters were fixed to zero
due to the sparse nature of the data. In this vignette, we do not
consider more than 5 classes, because the analyses are computationally
very intensive and the data were simulated from a 3-class model.</p>
<p>It is important to highlight that in LCGA, the subgroups will be
limited by the specify growth structure, meaning that LCA will identify
distinctive growth patterns within the intercept, step, and slope
growth. For example, if there is a subgroup that follows a quadratic
growth pattern this models will not be able to identify it.</p>
<p><strong>NOTE: The time scales in this model are not correct; it
currently assumes that all measurements are equidistant. Feel free to
experiment with adjusting this.</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">27796</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">[[</span><span class="st">"id"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">res_step</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mx_growth_mixture.html">mx_growth_mixture</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">  i =~ 1*scl1 + 1*scl2 + 1*scl3 +1*scl4 +1*scl5 +1*scl6</span></span>
<span><span class="st">  step =~ 0*scl1 + 1*scl2 + 1*scl3 +1*scl4 +1*scl5 +1*scl6</span></span>
<span><span class="st">  s =~ 0*scl1 + 0*scl2 + 1*scl3 +2*scl4 +3*scl5 +4*scl6</span></span>
<span><span class="st">  scl1 ~~ vscl1*scl1</span></span>
<span><span class="st">  scl2 ~~ vscl2*scl2</span></span>
<span><span class="st">  scl3 ~~ vscl3*scl3</span></span>
<span><span class="st">  scl4 ~~ vscl4*scl4</span></span>
<span><span class="st">  scl5 ~~ vscl5*scl5</span></span>
<span><span class="st">  scl6 ~~ vscl6*scl6</span></span>
<span><span class="st">  i ~~ 0*i</span></span>
<span><span class="st">  step ~~ 0*step</span></span>
<span><span class="st">  s ~~ 0*s</span></span>
<span><span class="st">  i ~~ 0*s</span></span>
<span><span class="st">  i ~~ 0*step</span></span>
<span><span class="st">  s ~~ 0*step"</span>,</span>
<span>    classes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="co"># Additional iterations because of convergence problems for</span></span>
<span><span class="co"># model 1:</span></span>
<span><span class="va">res_step</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mxTryHardWideSearch</span><span class="op">(</span><span class="va">res_step</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, extraTries <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>Note that the first model showed convergence problems, throwing the
error: <em>The model does not satisfy the first-order optimality
conditions to the required accuracy, and no improved point for the merit
function could be found during the final linesearch.</em> To address
this problem, we performed additional iterations to<br>
find a better solution, using
<code><a href="https://rdrr.io/pkg/OpenMx/man/mxTryHard.html" class="external-link">OpenMx::mxTryHardWideSearch()</a></code>. This also illustrates that
<code>tidySEM</code> mixture models inherit from <code>OpenMx</code>’s
<code>MxModel</code>, and thus, different <code>OpenMx</code> functions
can be used to act on models specified via <code>tidySEM</code>.</p>
<p>The fifth model also evidenced convergence problems, but this (as we
will see) is because the solution is overfitted.</p>
<div class="section level3">
<h3 id="class-enumeration">Class enumeration<a class="anchor" aria-label="anchor" href="#class-enumeration"></a>
</h3>
<p>To determine the correct number of classes, we considered the
following criteria:</p>
<ol style="list-style-type: decimal">
<li>We do not consider classes with, on average, fewer than 5
participants per parameter in a class due to potential local
underidentification</li>
<li>Lower values for information criteria (AIC, BIC, saBIC) indicate
better fit</li>
<li>Significant Lo-Mendell-Rubin LRT test indicates better fit for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
vs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k-1</annotation></semantics></math>
classes</li>
<li>We do not consider solutions with entropy &lt; .90 because poor
class separability compromises interpretability of the results</li>
<li>We do not consider solutions with minimum posterior classification
probability &lt; .90 because poor class separability compromises
interpretability of the results</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get fit table fit</span></span>
<span><span class="va">tab_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/table_fit.html">table_fit</a></span><span class="op">(</span><span class="va">res_step</span><span class="op">)</span></span>
<span><span class="co"># Select columns</span></span>
<span><span class="va">tab_fit</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"Classes"</span>, <span class="st">"LL"</span>, <span class="st">"Parameters"</span>, <span class="st">"BIC"</span>, <span class="st">"Entropy"</span>,</span>
<span>    <span class="st">"prob_min"</span>, <span class="st">"n_min"</span>, <span class="st">"warning"</span>, <span class="st">"lmr_p"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>According to the Table, increasing the number of classes keeps
increasing model fit according to all ICs except the BIC, which
increased after 3 classes.</p>
<p>The first two LMR tests are significant, indicating that a 2- and
3-class solution were a significant improvement over a 1- and 2-class
solution, respectively. However, solutions with &gt;3 classes had
entropy and minimum posterior classification probability below the
pre-specified thresholds. Models with &gt;3 solutions also had fewer
than five observations per parameter. This suggests that the preferred
model should be selected from 1-3 classes.</p>
<div class="section level4">
<h4 id="scree-plot">Scree plot<a class="anchor" aria-label="anchor" href="#scree-plot"></a>
</h4>
<p>A scree plot indicates that the largest decrease in ICs occurs from
1-2 classes, and the inflection point for all ICs is at 3 classes.
Moreover, the BIC increased after 3 classes. A three-class solution thus
appears to be the most parsimonious solution with good fit.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tab_fit</span>, statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"saBIC"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Based on the aforementioned criteria, we selected a 3-class model for
further analyses. First, to prevent label switching, we re-order these
classes by the value of the intercept <code>i</code>. Then, we report
the estimated parameters.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mx_switch_labels.html">mx_switch_labels</a></span><span class="op">(</span><span class="va">res_step</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, param <span class="op">=</span> <span class="st">"M[1,7]"</span>,</span>
<span>    decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">tab_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/table_results.html">table_results</a></span><span class="op">(</span><span class="va">res_final</span>, columns <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co"># Select rows and columns</span></span>
<span><span class="va">tab_res</span> <span class="op">&lt;-</span> <span class="va">tab_res</span><span class="op">[</span><span class="va">tab_res</span><span class="op">$</span><span class="va">Category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Means"</span>, <span class="st">"Variances"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Category"</span>, <span class="st">"lhs"</span>, <span class="st">"est"</span>, <span class="st">"se"</span>, <span class="st">"pval"</span>, <span class="st">"confint"</span>, <span class="st">"name"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">tab_res</span></span></code></pre></div>
<p>As evident from these results, Class 1 started at a relatively lower
level of depressive symptoms, experienced a decrease after deployment,
followed by increase over time. Class 2 started at a moderate level of
depressive symptoms, experienced an increase after deployment, followed
by significant increase over time from T2-T6. Class 3 started at a
relatively higher level, experienced an increase after deployment,
followed by stability.</p>
</div>
</div>
<div class="section level3">
<h3 id="wald-tests">Wald tests<a class="anchor" aria-label="anchor" href="#wald-tests"></a>
</h3>
<p>To test whether parameters are significantly different between
classes, we can use Wald tests. Wald tests can be specified for all
parameters in the model, using the hypothesis syntax from the
<code>bain</code> package for informative hypothesis testing.</p>
<p>To identify the names of parameters in the model, we can use the
<code>name</code> column of the results table above. Alternatively, to
see all parameters in the model, run:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">res_final</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, specify equality constrained hypotheses. For example, a
hypothesis that states that the mean intercept is equal across groups is
specified as follows:</p>
<p><code>"class1.M[1,7] = class2.M[1,7] &amp; class1.M[1,7] = class3.M[1,7]</code></p>
<p>It is also possible to consider comparisons between two classes at a
time. When conducting many significance tests, consider correcting for
multiple comparisons however.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wald_tests</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wald_test.html">wald_test</a></span><span class="op">(</span><span class="va">res_final</span>, <span class="st">"</span></span>
<span><span class="st">                   class1.M[1,7] = class2.M[1,7]&amp;</span></span>
<span><span class="st">                   class1.M[1,7] = class3.M[1,7];</span></span>
<span><span class="st">                   class1.M[1,8] = class2.M[1,8]&amp;</span></span>
<span><span class="st">                   class1.M[1,8] = class3.M[1,8];</span></span>
<span><span class="st">                   class1.M[1,9] = class2.M[1,9]&amp;</span></span>
<span><span class="st">                   class1.M[1,9] = class3.M[1,9]"</span><span class="op">)</span></span>
<span><span class="co"># Rename the hypothesis</span></span>
<span><span class="va">wald_tests</span><span class="op">$</span><span class="va">Hypothesis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean i"</span>, <span class="st">"Mean step"</span>, <span class="st">"Mean slope"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">wald_tests</span>, digits <span class="op">=</span> <span class="fl">2</span>, caption <span class="op">=</span> <span class="st">"Wald tests"</span><span class="op">)</span></span></code></pre></div>
<p>All Wald tests are significant, indicating that there are significant
differences between the intercepts, step function, and slopes of the
three classes.</p>
</div>
<div class="section level3">
<h3 id="trajectory-plot">Trajectory plot<a class="anchor" aria-label="anchor" href="#trajectory-plot"></a>
</h3>
<p>Finally, we can plot the growth trajectories. This can help interpret
the results better, as well as the residual heterogeneity around class
trajectories.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_growth.html">plot_growth</a></span><span class="op">(</span><span class="va">res_step</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, rawdata <span class="op">=</span> <span class="cn">TRUE</span>, alpha_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>    <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Add Y-axis breaks in original scale</span></span>
<span><span class="va">brks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">invbc</span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="va">brks</span>, from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, to <span class="op">=</span> <span class="va">rng_bc</span><span class="op">)</span>,</span>
<span>    <span class="va">lambda</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">labs</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"SCL (rescaled from Box-Cox)"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p>Note that the observed individual trajectories show very high
variability within classes.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Caspar J. van Lissa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
