<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Mixed Data LCA • tidySEM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mixed Data LCA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidySEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Generating_syntax.html">Generating syntax for structural equation models</a></li>
    <li><a class="dropdown-item" href="../articles/lca_confirmatory.html">Confirmatory LPA for the Caregiver Compass</a></li>
    <li><a class="dropdown-item" href="../articles/lca_exploratory.html">Exploratory LPA for Ocean Microplastics</a></li>
    <li><a class="dropdown-item" href="../articles/lca_lcga.html">Latent Class Growth Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lca_ordinal.html">Latent Class Analysis for Ordinal Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_lca.html">Mixed Data LCA</a></li>
    <li><a class="dropdown-item" href="../articles/Plotting_graphs.html">Plotting graphs for structural equation models</a></li>
    <li><a class="dropdown-item" href="../articles/sem_graph.html">SEM graphing conventions</a></li>
    <li><a class="dropdown-item" href="../articles/SMART_LCA_checklist.html">SMART-LCA Checklist</a></li>
    <li><a class="dropdown-item" href="../articles/Tabulating_results.html">Tabulating results from structural equation models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cjvanlissa/tidySEM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mixed Data LCA</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cjvanlissa/tidySEM/blob/master/vignettes/mixed_lca.Rmd" class="external-link"><code>vignettes/mixed_lca.Rmd</code></a></small>
      <div class="d-none name"><code>mixed_lca.Rmd</code></div>
    </div>

    
    
<p>Latent class analysis for categorical indicators (LCA) and latent
profile analysis for continuous indicators (LPA) are widely used mixture
modeling techniques for identifying unobserved subgroups in a
population. In practice, researchers often encounter <strong>mixed data
types</strong>: a combination of continuous, binary, and ordinal
indicators.</p>
<p>Estimating such models was complicated in prior versions of
<code>tidySEM</code>, and often led to convergence issues. The new
function <code><a href="../reference/mx_mixed_lca.html">mx_mixed_lca()</a></code>, introduced in <code>tidySEM</code>
version <code>0.2.10</code>, provides a high-level interface to estimate
mixed-data latent class models. At the same time, the function
<code>mx_run()</code> was updated to use <code><a href="https://rdrr.io/pkg/OpenMx/man/mxTryHard.html" class="external-link">mxTryHardOrdinal()</a></code>
in case of convergence issues with ordinal categorical indicators, which
improves the estimation of mixed data LCAs.</p>
<p>This vignette demonstrates how to:</p>
<ul>
<li>Prepare mixed continuous and ordinal data</li>
<li>Estimate mixed-data latent class models</li>
<li>Fit multiple class solutions</li>
<li>Inspect and interpret the resulting OpenMx models</li>
</ul>
<div class="section level3">
<h3 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h3>
<p>The <code><a href="../reference/mx_mixed_lca.html">mx_mixed_lca()</a></code> function relies on
<code>OpenMx</code>. Make sure both packages are installed and
loaded.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cjvanlissa.github.io/tidySEM/">tidySEM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openmx.ssri.psu.edu/" class="external-link">OpenMx</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-data">Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>We simulate a dataset with:</p>
<ul>
<li>Three continuous indicators</li>
<li>One ordinal indicator</li>
<li>Two latent classes</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># Set class-specific means</span></span>
<span><span class="va">class_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.3</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fl">0.7</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate continuous indicators</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">class_means</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">df</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert one indicator to ordinal</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">X4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">X4</span>, breaks <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">X4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxFactor.html" class="external-link">mxFactor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">X4</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-estimation-with-mx_mixed_lca">Model Estimation with <code>mx_mixed_lca()</code><a class="anchor" aria-label="anchor" href="#model-estimation-with-mx_mixed_lca"></a>
</h3>
<!-- The `mx_mixed_lca()` function estimates mixed-data latent class models using the -->
<!-- following procedure: -->
<!-- 1. Estimate an **Latent profile analysis (LPA)** for the continuous indicators using -->
<!--    `mx_profiles()` -->
<!-- 2. Use the **BCH method** to obtain starting values for ordinal indicators: the classes probabilities from step 1 are used to estimate thresholds for the remaining ordinal indicators. -->
<!-- 3. **Latent class analysis (LCA)** for ordinal indicators using `mx_lca()`, using the thresholds from step 2. as starting values. -->
<!-- 4. **Joint estimation** of continuous and ordinal indicators in a single model, using the results from steps 1. and 3. as starting values. -->
<div class="section level4">
<h4 id="estimating-a-single-class-solution">Estimating a Single Class Solution<a class="anchor" aria-label="anchor" href="#estimating-a-single-class-solution"></a>
</h4>
<p>To estimate a 2-class mixed-data latent class model, use the
following code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mx_mixed_lca.html">mx_mixed_lca</a></span><span class="op">(</span></span>
<span>data <span class="op">=</span> <span class="va">df</span>,</span>
<span>classes <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The returned object is an <code><a href="https://rdrr.io/pkg/OpenMx/man/mxModel.html" class="external-link">OpenMx::mxModel</a></code>, and can be
modified using the functions in that package:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">res_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "MxModel"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "OpenMx"</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="estimating-multiple-class-solutions">Estimating Multiple Class Solutions<a class="anchor" aria-label="anchor" href="#estimating-multiple-class-solutions"></a>
</h3>
<p>A common workflow is to estimate several class solutions and compare
model fit. This can be done by passing a vector of class numbers.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_1_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mx_mixed_lca.html">mx_mixed_lca</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  classes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The result is a list of OpenMx models, one for each class
solution.</p>
</div>
<div class="section level3">
<h3 id="class-enumeration">Class Enumeration<a class="anchor" aria-label="anchor" href="#class-enumeration"></a>
</h3>
<p>As explained in Van Lissa, Garnier-Villareal, and Anadria (2023),
there are several approaches to class enumeration. The most
straightforward best-practice approach is to examine the BIC fit index,
and select the model with the lowest BIC. This is obtained by inspecting
model fit, by printing the object, or calling
<code>table_fit(res_1_3)</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table_fit.html">table_fit</a></span><span class="op">(</span><span class="va">res_1_3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;     Name Classes        LL   n Parameters      AIC      BIC    saBIC   Entropy</span></span>
<span><span class="co">#&gt; 1  equal       1 -1250.528 200          8 2517.055 2543.442 2518.097 1.0000000</span></span>
<span><span class="co">#&gt; 2 equal1       2 -1118.542 200         14 2265.083 2311.260 2266.906 0.9304968</span></span>
<span><span class="co">#&gt; 3 equal2       3 -1115.041 200         20 2270.083 2336.049 2272.687 0.9447551</span></span>
<span><span class="co">#&gt;    prob_min  prob_max n_min n_max np_ratio  np_local</span></span>
<span><span class="co">#&gt; 1 1.0000000 1.0000000 1.000 1.000 25.00000 25.000000</span></span>
<span><span class="co">#&gt; 2 0.9606636 0.9942737 0.295 0.705 14.28571  9.076923</span></span>
<span><span class="co">#&gt; 3 0.9386326 0.9976012 0.075 0.630 10.00000  2.500000</span></span></code></pre>
<p>As expected, the BIC for the 2-class solution is lowest. Note that
the 3-class solution also has an extremely low ratio of cases to
parameters, so this model is most likely overfit.</p>
<p>Another best-practice approach to class enumeration is to perform the
bootstrapped likelihood ratio test. This gives a significance test, but
takes a long time to run. To accelerate computations, we can use the
<code>future</code> package for parallel computing (see
<code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">?plan</a></code> to select the appropriate back-end for your system).
To track the function’s progress, we use the <code>progressr</code>
ecosystem, which allows users to choose how they want to be informed.
The example below uses a progress bar:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org" class="external-link">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span> <span class="co"># Parallel processing for Windows</span></span>
<span><span class="fu"><a href="https://progressr.futureverse.org/reference/handlers.html" class="external-link">handlers</a></span><span class="op">(</span><span class="st">"progress"</span><span class="op">)</span> <span class="co"># Progress bar</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">res_blrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BLRT.html">BLRT</a></span><span class="op">(</span><span class="va">res_1_3</span>, replications <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">res_blrt</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Bootstrapped Likelihood Ratio Test:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         null         alt  lr df blrt_p samples</span></span>
<span><span class="co">#&gt;  equal var 1 equal var 2 264  6   0.00      42</span></span>
<span><span class="co">#&gt;  equal var 2 equal var 3   7  6   0.32      17</span></span></code></pre>
<p>This test, too, confirms that the 2-class solution is significantly
better than the 1-class solution - but the 3-class solution offers no
further significant improvement. Note that, by default, the BLRT
conducts 100 bootstrapped analyses - but only some of these samples
could be used to conduct the test, as the model did not converge in
remaining iterations.</p>
<p>A third option is to use a predictive model comparison, a method
conceptually similar to Bayesian posterior predictive checks.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">res_pmc_srmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmc_srmr.html">pmc_srmr</a></span><span class="op">(</span><span class="va">res_1_3</span><span class="op">)</span></span>
<span><span class="va">res_pmc_srmr</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   comparison        null         alt  null_srsm   alt_srsm     srmr_lb</span></span>
<span><span class="co">#&gt; 1    dif_seq equal var 1 equal var 2 0.46920642 0.06900679 -0.45910956</span></span>
<span><span class="co">#&gt; 2    dif_seq equal var 2 equal var 3 0.06900679 0.05695099 -0.05869216</span></span>
<span><span class="co">#&gt; 3    dif_one equal var 1 equal var 2 0.46920642 0.06900679 -0.45910956</span></span>
<span><span class="co">#&gt; 4    dif_one equal var 1 equal var 3 0.46920642 0.05695099 -0.47293413</span></span>
<span><span class="co">#&gt;       srmr_ub sig</span></span>
<span><span class="co">#&gt; 1 -0.32814646   *</span></span>
<span><span class="co">#&gt; 2  0.03553646    </span></span>
<span><span class="co">#&gt; 3 -0.32814646   *</span></span>
<span><span class="co">#&gt; 4 -0.35111805   *</span></span></code></pre>
<p>This test, too, confirms that the 2-class solution is significantly
better than the 1-class solution - but the 3-class solution offers no
further significant improvement.</p>
</div>
<div class="section level3">
<h3 id="examine-results">Examine Results<a class="anchor" aria-label="anchor" href="#examine-results"></a>
</h3>
<p>We can investigate the class proportions for the two-class solution
by calling:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/class_prob.html">class_prob</a></span><span class="op">(</span><span class="va">res_1_3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sum.posterior"</span>, <span class="st">"sum.mostlikely"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $sum.posterior</span></span>
<span><span class="co">#&gt;    class     count proportion</span></span>
<span><span class="co">#&gt; 1 class1 139.41514  0.6970757</span></span>
<span><span class="co">#&gt; 2 class2  60.58486  0.3029243</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sum.mostlikely</span></span>
<span><span class="co">#&gt;    class count proportion</span></span>
<span><span class="co">#&gt; 1 class1   141      0.705</span></span>
<span><span class="co">#&gt; 2 class2    59      0.295</span></span></code></pre>
<p>The sum.posterior class probabilities incorporate classification
error; each case can (fractionally) contribute to multiple classes.</p>
<p>The sum.mostlikely class probabilities ignore classification error,
assigning each case to the class it has the highest class probability
for.</p>
<p>Note that, in this case, both correspond nicely to the simulated
.3/.7 split. Thus, we should have good class discrimination.</p>
<p>This is confirmed by checking:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table_fit.html">table_fit</a></span><span class="op">(</span><span class="va">res_1_3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   Minus2LogLikelihood   n Parameters observedStatistics   df TLI RMSEA</span></span>
<span><span class="co">#&gt; 1            2237.083 200         14               1600 1586   1     0</span></span>
<span><span class="co">#&gt;   RMSEASquared RMSEANull   modelName      AIC     BIC    saBIC Classes</span></span>
<span><span class="co">#&gt; 1            0      0.05 equal var 2 2265.083 2311.26 2266.906       2</span></span>
<span><span class="co">#&gt;     Entropy  prob_min  prob_max n_min n_max        LL</span></span>
<span><span class="co">#&gt; 1 0.9304968 0.9606636 0.9942737 0.295 0.705 -1118.542</span></span></code></pre>
<p>We have a high minimal- and maximal posterior classification
probability, and a high entropy.</p>
<p>Finally, we can examine the parameter values using
<code><a href="../reference/table_results.html">table_results()</a></code> on the second element of the model list, or
the 2-class model:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table_results.html">table_results</a></span><span class="op">(</span><span class="va">res_1_3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;                       label  est_sig       se pval               confint  class</span></span>
<span><span class="co">#&gt; 1                  Means.X1  1.94***     0.08 0.00          [1.78, 2.10] class1</span></span>
<span><span class="co">#&gt; 2                  Means.X2  4.39***     0.17 0.00          [4.05, 4.73] class1</span></span>
<span><span class="co">#&gt; 3                  Means.X3  1.01***     0.05 0.00          [0.92, 1.11] class1</span></span>
<span><span class="co">#&gt; 4              Variances.X1  0.89***     0.09 0.00          [0.71, 1.07] class1</span></span>
<span><span class="co">#&gt; 5              Variances.X2  3.94***     0.42 0.00          [3.12, 4.75] class1</span></span>
<span><span class="co">#&gt; 6              Variances.X3  0.31***     0.03 0.00          [0.25, 0.37] class1</span></span>
<span><span class="co">#&gt; 7              Variances.X4     1.00       NA   NA                  &lt;NA&gt; class1</span></span>
<span><span class="co">#&gt; 8    class1.Thresholds[1,1] -1.24***     0.15 0.00        [-1.52, -0.95] class1</span></span>
<span><span class="co">#&gt; 9    class1.Thresholds[2,1]  0.89***     0.12 0.00          [0.65, 1.13] class1</span></span>
<span><span class="co">#&gt; 10                 Means.X1    -0.23     0.13 0.07         [-0.48, 0.02] class2</span></span>
<span><span class="co">#&gt; 11                 Means.X2    -0.11     0.27 0.67         [-0.64, 0.41] class2</span></span>
<span><span class="co">#&gt; 12                 Means.X3    -0.00     0.07 0.98         [-0.15, 0.14] class2</span></span>
<span><span class="co">#&gt; 13             Variances.X4     1.00       NA   NA                  &lt;NA&gt; class2</span></span>
<span><span class="co">#&gt; 14   class2.Thresholds[1,1]  0.65***     0.18 0.00          [0.29, 1.01] class2</span></span>
<span><span class="co">#&gt; 15   class2.Thresholds[2,1]     7.11 35680.19 1.00 [-69924.78, 69939.01] class2</span></span>
<span><span class="co">#&gt; 16 equal var 2.weights[1,1]     1.00       NA   NA                  &lt;NA&gt;   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 17 equal var 2.weights[1,2]  0.43***     0.07 0.00          [0.30, 0.57]   &lt;NA&gt;</span></span></code></pre>
<p>Note that we get free means for each class, with the variances
constrained to be equal across classes. For the categorical variable, we
get thresholds: These correspond to quartiles of a normal distribution.
For class 1, the probability of scoring within the first response
category corresponds to <code>pnorm(-2.38, lower.tail = TRUE)</code>, or
about 1%. To convert these thresholds to the probability scale, we can
run:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table_prob.html">table_prob</a></span><span class="op">(</span><span class="va">res_1_3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   Variable Category  Probability  group</span></span>
<span><span class="co">#&gt; 1       X4        1 1.082529e-01 class1</span></span>
<span><span class="co">#&gt; 2       X4        2 7.052537e-01 class1</span></span>
<span><span class="co">#&gt; 3       X4        3 1.864934e-01 class1</span></span>
<span><span class="co">#&gt; 4       X4        1 7.412398e-01 class2</span></span>
<span><span class="co">#&gt; 5       X4        2 2.587602e-01 class2</span></span>
<span><span class="co">#&gt; 6       X4        3 5.663248e-13 class2</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="advanced-options">Advanced Options<a class="anchor" aria-label="anchor" href="#advanced-options"></a>
</h3>
<p>Additional arguments can be passed via <code>...</code> and are
forwarded to the underlying model-building functions. For example, you
can release the variance constraints for the continuous indicators by
passing the <code>variances</code> argument of
<code><a href="../reference/mx_profiles.html">mx_profiles()</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_2_free</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mx_mixed_lca.html">mx_mixed_lca</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  classes <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  variances <span class="op">=</span> <span class="st">"varying"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can compare the BICs of these models to determine whether the
added complexity improves the model fit:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  fixed_covs <span class="op">=</span> <span class="va">res_1_3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  free_covs <span class="op">=</span> <span class="va">res_2_free</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/table_fit.html">table_fit</a></span><span class="op">(</span><span class="va">compare</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;         Name Classes        LL   n Parameters      AIC      BIC    saBIC</span></span>
<span><span class="co">#&gt; 1 fixed_covs       2 -1118.542 200         14 2265.083 2311.260 2266.906</span></span>
<span><span class="co">#&gt; 2  free_covs       2 -1117.967 200         17 2269.935 2326.006 2272.148</span></span>
<span><span class="co">#&gt;     Entropy  prob_min  prob_max n_min n_max np_ratio np_local</span></span>
<span><span class="co">#&gt; 1 0.9304968 0.9606636 0.9942737 0.295 0.705 14.28571 9.076923</span></span>
<span><span class="co">#&gt; 2 0.9353582 0.9680273 0.9931100 0.295 0.705 11.76471 7.375000</span></span></code></pre>
<p>Note that the BIC of the model with free covariances is higher than
that of the model with fixed variances, so it fits worse. This is as
expected, because we did not simulate class-specific variances.</p>
</div>
<div class="section level2">
<h2 id="plotting-the-model">Plotting the Model<a class="anchor" aria-label="anchor" href="#plotting-the-model"></a>
</h2>
<p>The model can be plot with the usual functions, but note that
categorical indicators will not look good in plots for continuous
indicators, and could lead to errors.</p>
<p>Thus, for example, we can use a profile plot for the continuous
indicators:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_profiles.html">plot_profiles</a></span><span class="op">(</span><span class="va">res_1_3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mixed_lca_profiles.png"><!-- --></p>
<p>Alternatively, we can use a bivariate plot with densities:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_bivariate.html">plot_bivariate</a></span><span class="op">(</span><span class="va">res_1_3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mixed_lca_bivariate.png"><!-- --></p>
<p>We can plot the categorical variables as follows:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prob.html">plot_prob</a></span><span class="op">(</span><span class="va">res_1_3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="mixed_lca_prob.png"><!-- --></p>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Van Lissa, C. J., Garnier-Villarreal, M., &amp; Anadria, D. (2023).
<em>Recommended Practices in Latent Class Analysis using the Open-Source
R-Package tidySEM.</em> Structural Equation Modeling. <a href="https://doi.org/10.1080/10705511.2023.2250920" class="external-link">https://doi.org/10.1080/10705511.2023.2250920</a></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Caspar J. van Lissa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
