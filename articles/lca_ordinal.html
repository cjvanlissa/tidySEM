<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Latent Class Analysis for Ordinal Indicators • tidySEM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Latent Class Analysis for Ordinal Indicators">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidySEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Generating_syntax.html">Generating syntax for structural equation models</a></li>
    <li><a class="dropdown-item" href="../articles/lca_confirmatory.html">Confirmatory LPA for the Caregiver Compass</a></li>
    <li><a class="dropdown-item" href="../articles/lca_exploratory.html">Exploratory LPA for Ocean Microplastics</a></li>
    <li><a class="dropdown-item" href="../articles/lca_lcga.html">Latent Class Growth Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lca_ordinal.html">Latent Class Analysis for Ordinal Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/Plotting_graphs.html">Plotting graphs for structural equation models</a></li>
    <li><a class="dropdown-item" href="../articles/sem_graph.html">SEM graphing conventions</a></li>
    <li><a class="dropdown-item" href="../articles/SMART_LCA_checklist.html">SMART-LCA Checklist</a></li>
    <li><a class="dropdown-item" href="../articles/Tabulating_results.html">Tabulating results from structural equation models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cjvanlissa/tidySEM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Latent Class Analysis for Ordinal Indicators</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cjvanlissa/tidySEM/blob/master/vignettes/lca_ordinal.Rmd" class="external-link"><code>vignettes/lca_ordinal.Rmd</code></a></small>
      <div class="d-none name"><code>lca_ordinal.Rmd</code></div>
    </div>

    
    
<p>This is an example of exploratory LCA with ordinal indicators using
<code>tidySEM</code>, as explained in Van Lissa, C. J.,
Garnier-Villarreal, M., &amp; Anadria, D. (2023). <em>Recommended
Practices in Latent Class Analysis using the Open-Source R-Package
tidySEM.</em> Structural Equation Modeling. <a href="https://doi.org/10.1080/10705511.2023.2250920" class="external-link uri">https://doi.org/10.1080/10705511.2023.2250920</a>. The
present example uses synthetic data based on a study by Maene and
colleagues. In a convenience sample of Flemish (Belgian) high-school
students with a migration background, this study set out to identify
distinct classes based on ordinal indicators of National, Regional, and
Heritage identity. Sample size was not justified.</p>
<p>The approach to class enumeration was semi-theory driven: The
researchers expected to find profiles that were distinct on all three
types of identity (national, regional, and heritage) - but the exact
number of classes was not pre-specified (hypothesis 1).</p>
<p>Hypothesis 2 stated that adolescents who are nationally integrated
would have lower depressive feelings than students from students with
other combinations of identifications (hypothesis 2). Hypothesis 3 was
that, for assimilated and separated adolescents, there would not be a
significant effect of perceived teacher discrimination on depressive
symptoms.</p>
<p>Use the command <code><a href="../reference/maene_identity.html">?tidySEM::maene_identity</a></code> to view the
data documentation.</p>
<div class="section level2">
<h2 id="loading-the-data">Loading the Data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h2>
<p>To load the data, simply attach the <code>tidySEM</code> package. For
convenience, we assign the indicator data to an object called
<code>df</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cjvanlissa.github.io/tidySEM/">tidySEM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># Load data</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">maene_identity</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examining-the-data">Examining the Data<a class="anchor" aria-label="anchor" href="#examining-the-data"></a>
</h2>
<p>We use <code><a href="../reference/descriptives.html">tidySEM::descriptives()</a></code> to describe the data
numerically. Because all items are categorical, we remove columns for
continuous data to de-clutter the table:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">desc</span> <span class="op">&lt;-</span> <span class="fu">tidySEM</span><span class="fu">::</span><span class="fu"><a href="../reference/descriptives.html">descriptives</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">desc</span> <span class="op">&lt;-</span> <span class="va">desc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"type"</span>, <span class="st">"n"</span>, <span class="st">"missing"</span>, <span class="st">"unique"</span>, <span class="st">"mode"</span>,</span>
<span>    <span class="st">"mode_value"</span>, <span class="st">"v"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">desc</span></span></code></pre></div>
<table class="table">
<caption>Descriptive statistics for ordinal items</caption>
<colgroup>
<col width="13%">
<col width="24%">
<col width="6%">
<col width="12%">
<col width="10%">
<col width="7%">
<col width="16%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">type</th>
<th align="right">n</th>
<th align="right">missing</th>
<th align="right">unique</th>
<th align="right">mode</th>
<th align="right">mode_value</th>
<th align="right">v</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Ethnic_1</td>
<td align="left">ordered, factor</td>
<td align="right">439</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">269</td>
<td align="right">5</td>
<td align="right">0.53</td>
</tr>
<tr class="even">
<td align="left">Ethnic_2</td>
<td align="left">ordered, factor</td>
<td align="right">439</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">272</td>
<td align="right">5</td>
<td align="right">0.52</td>
</tr>
<tr class="odd">
<td align="left">Ethnic_3</td>
<td align="left">ordered, factor</td>
<td align="right">439</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">262</td>
<td align="right">5</td>
<td align="right">0.54</td>
</tr>
<tr class="even">
<td align="left">Belgian</td>
<td align="left">ordered, factor</td>
<td align="right">439</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="right">88</td>
<td align="right">7</td>
<td align="right">0.86</td>
</tr>
<tr class="odd">
<td align="left">Flemish</td>
<td align="left">ordered, factor</td>
<td align="right">439</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="right">90</td>
<td align="right">7</td>
<td align="right">0.87</td>
</tr>
</tbody>
</table>
<p>Additionally, we can plot the data. The <code>ggplot2</code> function
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar()</a></code> is useful for ordinal data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_plot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Value."</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_plot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span><span class="va">df_plot</span>, varying <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_plot</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"long"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">time</span>,</span>
<span>    scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="lca_plot_desc.png" class="r-plt" alt="Bar charts for ordinal indicators" width="80%"><p class="caption">
Bar charts for ordinal indicators
</p>
</div>
<p>As we can see, the <code><a href="../reference/descriptives.html">descriptives()</a></code> table provides
invaluable information about the measurement level of the indicators,
which is used to specify the model correctly. If these data had not been
coded as ordinal factors, these descriptive statistics would have
revealed that each variable has only 5-10 unique values. The proportion
of missing values is reported in the <code>"missing"</code> column. If
any variables had missing values, we would report an MCAR test with
<code><a href="https://amices.org/mice/reference/mcar.html" class="external-link">mice::mcar()</a></code> and explain that missing data are accounted
for using FIML. In our example, we see that there are no missing values,
hence we proceed with our analysis. Note that the ethic identification
variables are very right-skewed and some response categories have
near-zero frequencies; this can cause problems in model specification
and convergence. One potential solution would be to merge small adjacent
categories. We will not do this here, however.</p>
</div>
<div class="section level2">
<h2 id="conducting-latent-class-analysis">Conducting Latent Class Analysis<a class="anchor" aria-label="anchor" href="#conducting-latent-class-analysis"></a>
</h2>
<p>Before we fit a series of LCA models, we set a random seed using
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>. This is important because there is some
inherent randomness in the estimation procedure, and using a seed
ensures that we (and others) can exactly reproduce the results.</p>
<p>Next, we fit the LCA models. As all variables are ordinal, we can use
the convenience function <code><a href="../reference/mx_lca.html">tidySEM::mx_lca()</a></code>, which is a
wrapper for the generic function <code><a href="../reference/mx_mixture.html">mx_mixture()</a></code> optimized for
LCA with ordinal data. Any mixture model can be specified through
<code><a href="../reference/mx_mixture.html">mx_mixture()</a></code>. At the time of writing, there are two other
wrapper functions for special cases: <code><a href="../reference/mx_profiles.html">mx_profiles()</a></code>, for
latent profile analysis, and <code><a href="../reference/mx_growth_mixture.html">mx_growth_mixture()</a></code>, for
latent growth analysis and growth mixture models. All of these functions
have arguments <code>data</code> and number of <code>classes</code>. All
variables in <code>data</code> are included in the analysis, so relevant
variables must be selected first.</p>
<p>We here consider 1-6 class models, but note that this may be overfit,
as some of the indicators have only 5 response categories.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mx_lca.html">mx_lca</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, classes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="class-enumeration">Class Enumeration<a class="anchor" aria-label="anchor" href="#class-enumeration"></a>
</h2>
<p>In class enumeration, we want to compare a sequence of LCA models
fitted to the data. First, note that all models converged without
issues. If this had not been the case, it is possible to aid convergence
using <code><a href="https://rdrr.io/pkg/OpenMx/man/mxTryHard.html" class="external-link">mxTryHardOrdinal()</a></code>, which expands the search for
optimal parameter values for models with ordinal indicators. It is part
of the family of functions based on <code><a href="https://rdrr.io/pkg/OpenMx/man/mxTryHard.html" class="external-link">mxTryHard()</a></code>.</p>
<p>Next, we create a model fit table using <code><a href="../reference/table_fit.html">table_fit()</a></code> and
retain relevant columns. We also determine whether any models can be
disqualified.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/table_fit.html">table_fit</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">fit</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LL"</span>, <span class="st">"n"</span>, <span class="st">"Parameters"</span>, <span class="st">"BIC"</span>, <span class="st">"Entropy"</span>, <span class="st">"prob_min"</span>,</span>
<span>    <span class="st">"n_min"</span>, <span class="st">"np_ratio"</span>, <span class="st">"np_local"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<table class="table">
<caption>Model fit table</caption>
<colgroup>
<col width="6%">
<col width="8%">
<col width="5%">
<col width="15%">
<col width="6%">
<col width="11%">
<col width="12%">
<col width="8%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="right">Name</th>
<th align="right">LL</th>
<th align="right">n</th>
<th align="right">Parameters</th>
<th align="right">BIC</th>
<th align="right">Entropy</th>
<th align="right">prob_min</th>
<th align="right">n_min</th>
<th align="right">np_ratio</th>
<th align="right">np_local</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">-3076</td>
<td align="right">439</td>
<td align="right">30</td>
<td align="right">6334</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">14.6</td>
<td align="right">14.6</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">-2849</td>
<td align="right">439</td>
<td align="right">61</td>
<td align="right">6070</td>
<td align="right">0.89</td>
<td align="right">0.96</td>
<td align="right">0.46</td>
<td align="right">7.2</td>
<td align="right">6.7</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">-2747</td>
<td align="right">439</td>
<td align="right">92</td>
<td align="right">6054</td>
<td align="right">0.93</td>
<td align="right">0.94</td>
<td align="right">0.15</td>
<td align="right">4.8</td>
<td align="right">2.2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">-2659</td>
<td align="right">439</td>
<td align="right">123</td>
<td align="right">6066</td>
<td align="right">0.93</td>
<td align="right">0.94</td>
<td align="right">0.11</td>
<td align="right">3.6</td>
<td align="right">1.6</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">-2619</td>
<td align="right">439</td>
<td align="right">154</td>
<td align="right">6174</td>
<td align="right">0.95</td>
<td align="right">0.96</td>
<td align="right">0.10</td>
<td align="right">2.9</td>
<td align="right">1.5</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">-2578</td>
<td align="right">439</td>
<td align="right">185</td>
<td align="right">6281</td>
<td align="right">0.92</td>
<td align="right">0.94</td>
<td align="right">0.10</td>
<td align="right">2.4</td>
<td align="right">1.5</td>
</tr>
</tbody>
</table>
<p>Note that both the global and local ratio of cases to parameters is
low; for models of 3 or more classes, there are just a few observations
per parameter in the smallest class (see <code>np_local</code>). This is
a good reason to disqualify those classes. We will eliminate classes 4-6
on those criteria, but in real data applications, the 3-class solution
might also be disqualified.</p>
<p>In terms of classification diagnostics, note that the entropy and the
minimum classification probabilities are high for all models. This
indicates that all classes are distinct.</p>
</div>
<div class="section level2">
<h2 id="class-enumeration-1">Class Enumeration<a class="anchor" aria-label="anchor" href="#class-enumeration-1"></a>
</h2>
<div class="section level3">
<h3 id="using-bic">Using BIC<a class="anchor" aria-label="anchor" href="#using-bic"></a>
</h3>
<p>Based on the BIC, we would prefer the 2-class model. This decision is
also validated by a scree plot of the BIC, obtained by running
<code>plot(fit)</code>.</p>
</div>
<div class="section level3">
<h3 id="theoretical-considerations">Theoretical considerations<a class="anchor" aria-label="anchor" href="#theoretical-considerations"></a>
</h3>
<p>Despite the BIC indicating that the 2-class model is best, upon
examining the 2-class and 3-class solution, it was noted that
theoretically crucial distinctions between ethnic, regional (Flemish),
and national (Belgian) identity were not captured by the 2-class
solution but were captured by the 3-class solution. Based on this
theoretical consideration, the analysis proceeded with the 3-class
solution.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_final</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="interpreting-the-final-class-solution">Interpreting the Final Class Solution<a class="anchor" aria-label="anchor" href="#interpreting-the-final-class-solution"></a>
</h2>
<p>The 3-class model yielded classes of reasonable size; the largest
class comprised 33%, and the smallest comprised 16% of cases. The
entropy was high,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>.93</mn></mrow><annotation encoding="application/x-tex">S = .93</annotation></semantics></math>,
indicating good class separability. Furthermore, the posterior
classification probability ranged from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>.94</mn><mo>,</mo><mn>.99</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[.94, .99]</annotation></semantics></math>,
which means that all classes had low classification error. We can
produce a table of results using <code>table_results(res_final)</code>.
However, the results are thresholds, indicating quantiles of a
standardized normal distribution. These may be difficult to interpret.
Therefore, we ask for the results in probability scale:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/table_prob.html">table_prob</a></span><span class="op">(</span><span class="va">res_final</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span><span class="va">tab</span>, direction <span class="op">=</span> <span class="st">"wide"</span>, v.names <span class="op">=</span> <span class="st">"Probability"</span>, timevar <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>    idvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Variable"</span>, <span class="st">"Category"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Three-class model results in probability scale</caption>
<colgroup>
<col width="12%">
<col width="12%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="right">Category</th>
<th align="right">Probability.class1</th>
<th align="right">Probability.class2</th>
<th align="right">Probability.class3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Ethnic_1</td>
<td align="right">1</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">Ethnic_1</td>
<td align="right">2</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">Ethnic_1</td>
<td align="right">3</td>
<td align="right">0.20</td>
<td align="right">0.06</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">Ethnic_1</td>
<td align="right">4</td>
<td align="right">0.57</td>
<td align="right">0.24</td>
<td align="right">0.12</td>
</tr>
<tr class="odd">
<td align="left">Ethnic_1</td>
<td align="right">5</td>
<td align="right">0.21</td>
<td align="right">0.70</td>
<td align="right">0.85</td>
</tr>
<tr class="even">
<td align="left">Ethnic_2</td>
<td align="right">1</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">Ethnic_2</td>
<td align="right">2</td>
<td align="right">0.03</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">Ethnic_2</td>
<td align="right">3</td>
<td align="right">0.14</td>
<td align="right">0.13</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">Ethnic_2</td>
<td align="right">4</td>
<td align="right">0.74</td>
<td align="right">0.22</td>
<td align="right">0.03</td>
</tr>
<tr class="even">
<td align="left">Ethnic_2</td>
<td align="right">5</td>
<td align="right">0.09</td>
<td align="right">0.63</td>
<td align="right">0.97</td>
</tr>
<tr class="odd">
<td align="left">Ethnic_3</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">Ethnic_3</td>
<td align="right">2</td>
<td align="right">0.02</td>
<td align="right">0.03</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">Ethnic_3</td>
<td align="right">3</td>
<td align="right">0.15</td>
<td align="right">0.11</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">Ethnic_3</td>
<td align="right">4</td>
<td align="right">0.74</td>
<td align="right">0.24</td>
<td align="right">0.04</td>
</tr>
<tr class="odd">
<td align="left">Ethnic_3</td>
<td align="right">5</td>
<td align="right">0.07</td>
<td align="right">0.61</td>
<td align="right">0.94</td>
</tr>
<tr class="even">
<td align="left">Belgian</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.00</td>
<td align="right">0.16</td>
</tr>
<tr class="odd">
<td align="left">Belgian</td>
<td align="right">2</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
</tr>
<tr class="even">
<td align="left">Belgian</td>
<td align="right">3</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.06</td>
</tr>
<tr class="odd">
<td align="left">Belgian</td>
<td align="right">4</td>
<td align="right">0.02</td>
<td align="right">0.00</td>
<td align="right">0.02</td>
</tr>
<tr class="even">
<td align="left">Belgian</td>
<td align="right">5</td>
<td align="right">0.19</td>
<td align="right">0.00</td>
<td align="right">0.20</td>
</tr>
<tr class="odd">
<td align="left">Belgian</td>
<td align="right">6</td>
<td align="right">0.13</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="left">Belgian</td>
<td align="right">7</td>
<td align="right">0.34</td>
<td align="right">0.00</td>
<td align="right">0.17</td>
</tr>
<tr class="odd">
<td align="left">Belgian</td>
<td align="right">8</td>
<td align="right">0.25</td>
<td align="right">0.00</td>
<td align="right">0.20</td>
</tr>
<tr class="even">
<td align="left">Belgian</td>
<td align="right">9</td>
<td align="right">0.01</td>
<td align="right">0.18</td>
<td align="right">0.09</td>
</tr>
<tr class="odd">
<td align="left">Belgian</td>
<td align="right">10</td>
<td align="right">0.02</td>
<td align="right">0.82</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">Flemish</td>
<td align="right">1</td>
<td align="right">0.10</td>
<td align="right">0.00</td>
<td align="right">0.19</td>
</tr>
<tr class="odd">
<td align="left">Flemish</td>
<td align="right">2</td>
<td align="right">0.01</td>
<td align="right">0.01</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="left">Flemish</td>
<td align="right">3</td>
<td align="right">0.02</td>
<td align="right">0.00</td>
<td align="right">0.07</td>
</tr>
<tr class="odd">
<td align="left">Flemish</td>
<td align="right">4</td>
<td align="right">0.05</td>
<td align="right">0.00</td>
<td align="right">0.08</td>
</tr>
<tr class="even">
<td align="left">Flemish</td>
<td align="right">5</td>
<td align="right">0.14</td>
<td align="right">0.02</td>
<td align="right">0.17</td>
</tr>
<tr class="odd">
<td align="left">Flemish</td>
<td align="right">6</td>
<td align="right">0.11</td>
<td align="right">0.13</td>
<td align="right">0.13</td>
</tr>
<tr class="even">
<td align="left">Flemish</td>
<td align="right">7</td>
<td align="right">0.30</td>
<td align="right">0.10</td>
<td align="right">0.17</td>
</tr>
<tr class="odd">
<td align="left">Flemish</td>
<td align="right">8</td>
<td align="right">0.22</td>
<td align="right">0.17</td>
<td align="right">0.12</td>
</tr>
<tr class="even">
<td align="left">Flemish</td>
<td align="right">9</td>
<td align="right">0.03</td>
<td align="right">0.02</td>
<td align="right">0.02</td>
</tr>
<tr class="odd">
<td align="left">Flemish</td>
<td align="right">10</td>
<td align="right">0.01</td>
<td align="right">0.55</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<p>The results can also be interpreted by plotting the response
probabilities:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prob.html">plot_prob</a></span><span class="op">(</span><span class="va">res_final</span>, bw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="lca_prob.png" class="r-plt" alt="Probability plot" width="100%"><p class="caption">
Probability plot
</p>
</div>
<p>Note that the first class (33%) has relatively high identification
with the ethnic indicators and relatively low identification with
Belgian and Flemish identity. The second class (16%) has moderate
identification with Belgian and Flemish identity, and relatively low
identification with ethnic identity. Finally, the third class (50%) has
high identification with all identities.</p>
<p>Based on the probability plot, we can label class 1 as <em>ethic
identifiers</em>, class 2 as <em>low identifiers</em>, and class 3 as
<em>high identifiers</em>.</p>
</div>
<div class="section level2">
<h2 id="auxiliary-analyses">Auxiliary Analyses<a class="anchor" aria-label="anchor" href="#auxiliary-analyses"></a>
</h2>
<p>To address the remaining two hypotheses, we will perform auxiliary
analyses. Hypothesis 2 stated that adolescents who are nationally
integrated would have lower depressive feelings than students from
students with other combinations of identifications (hypothesis 2).</p>
<p>To test this hypothesis, we can call the BCH function and supply the
auxiliary variable depression to the <code>data</code> argument,
omitting the <code>model</code> argument. Below, we estimate an
auxiliary model to compare depressive symptoms across classes:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aux_dep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BCH.html">BCH</a></span><span class="op">(</span><span class="va">res_final</span>, data <span class="op">=</span> <span class="va">maene_identity</span><span class="op">$</span><span class="va">depression</span><span class="op">)</span></span></code></pre></div>
<p>To obtain an omnibus likelihood ratio test of the significance of
depression differences across classes, as well as pairwise comparisons
between classes, use <code>lr_test(aux_dep)</code>. The results indicate
that there are no significant differences in depression across classes,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>L</mi><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>4.32</mn><mo>,</mo><mi>p</mi><mo>=</mo><mn>.50</mn></mrow><annotation encoding="application/x-tex">\Delta LL(5) = 4.32, p = .50</annotation></semantics></math>.</p>
<p>Hypothesis 3 was that, for assimilated and separated adolescents,
there would not be a significant effect of perceived teacher
discrimination on depressive symptoms. To test this hypothesis, we will
compare the regression coefficient of discrimination on depressive
symptoms across classes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_aux</span> <span class="op">&lt;-</span> <span class="va">maene_identity</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vict_teacher"</span>, <span class="st">"depression"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Dummy-code vict_teacher</span></span>
<span><span class="va">df_aux</span><span class="op">$</span><span class="va">vict_teacher</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">df_aux</span><span class="op">$</span><span class="va">vict_teacher</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">aux_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BCH.html">BCH</a></span><span class="op">(</span><span class="va">res_final</span>, model <span class="op">=</span> <span class="st">"depression ~ vict_teacher"</span>,</span>
<span>    data <span class="op">=</span> <span class="va">df_aux</span><span class="op">)</span></span></code></pre></div>
<p>To view the coefficients of this model, we can use either
<code>coef(aux_model)</code> or
<code>table_results(aux_model, columns = NULL)</code>. As evident from
the results table, the coefficients labeled <code>class1.A[1,2]</code>
are the regression coefficients.</p>
<p>There are two ways to test the difference in regression coefficients
across classes: using <code>lr_test(aux_model, compare = "A")</code>, to
compare the ‘A matrix’ (regression coefficients) across classes, or
<code>wald_test(aux_model, "class1.A[1,2]=class2.A[1,2]&amp;class1.A[1,2]=class3.A[1,2]")</code>.
The results indicate that there are no significant differences in the
regression coefficients across classes,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1.16</mn><mo>,</mo><mi>p</mi><mo>=</mo><mn>.56</mn></mrow><annotation encoding="application/x-tex">\chi^2 (2) = 1.16, p = .56</annotation></semantics></math>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Caspar J. van Lissa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
